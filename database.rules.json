{
  "rules": {
    ".read": "auth != null",
    ".write": "auth != null",
    "users": {
      "$user_id": {
        ".write": "(auth != null) && ($user_id === auth.uid)",
        "bio": { ".validate": "newData.isString()" },
        "displayName": { ".validate": "newData.isString()" },
        "email": {
          ".validate": "newData.isString() && newData.val().matches(/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,4}$/i)"
        },
        "gender": { ".validate": "newData.isString()" },
        "photoURL": {
          ".validate": "newData.isString() && newData.val().matches(/^(ht|f)tp(s?):\\/\\/[0-9a-zA-Z]([-.\\w]*[0-9a-zA-Z])*((0-9)*)*(\\/?)([a-zA-Z0-9\\-\\.\\?\\,\\'\\/\\\\+&=%\\$#_]*)?$/)"
        },
        "onboardingComplete": { ".validate": "newData.isBoolean()" },
        "permissions": {
          "notifications": { ".validate": "newData.isBoolean()" },
          "location": { ".validate": "newData.isBoolean()" }
        },
        "interests": { ".validate": "newData.isString()" },
        "hosted_activities": {
          "$activity_id": {
            "activity_details": { ".validate": "newData.isString()" },
            "interested": {
              "$interested_user_id": {
                ".validate": "newData.child('userId').isString() && newData.child('timestamp').isNumber()"
              }
            },
            "approved": {
              "$approved_user_id": {
                ".validate": "newData.child('userId').isString() && newData.child('timestamp').isNumber()"
              }
            }
          }
        },
        "participating_activities": {
          "$activity_id": {
            "hostingUserId": { ".validate": "newData.isString()" },
            "activityId": { ".validate": "newData.isString()" },
            "timestamp": { ".validate": "newData.isNumber()" }
          }
        }
      }
    }
  }
}
